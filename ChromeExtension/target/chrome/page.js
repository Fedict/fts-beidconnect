function EIDChromeExt(){function e(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function n(n){return new Promise(function(t,i){n.correlationId=e(),n.src="EIDChromeExt.page",window.postMessage(n,"*"),o[n.correlationId]={resolve:t,reject:i}})}function t(e,n){var t=e.split("."),o=n.split(".");return o[0]>t[0]||o[0]===t[0]&&o[1]>=t[1]}var o={},i=function(e){this.message=e.result,this.report=e.report};i.prototype.toString=function(){return JSON.stringify(this)},window.addEventListener("message",function(e){if(e.source===window&&e.data.src&&"EIDChromeExt.background"===e.data.src)if(console.log("Page received: "),console.log(e.data),e.data.correlationId){var n=o[e.data.correlationId];if(void 0===n)return void console.log("No pending promise found, ignoring native reply");delete o[e.data.correlationId],"OK"===e.data.result?n.resolve(e.data):n.reject(new i(e.data))}else console.log("No correlationId in event msg")},!1),this.checkVersion=function(e,n,o,i){this.getVersion().then(function(o){var r=o.version;console.log("eIDLink version is "+r),t(e,r)?n(r):i(r)},function(e){o()})},this.getVersion=function(){return console.log("Getting version"),n({operation:"VERSION"})},this.sign=function(e,t,o,i,r,a){return console.log("Signing"),n({operation:"SIGN",cert:o,algo:i,digest:r,pin:a,language:e,mac:t})},this.auth=function(e,t,o,i,r,a){return console.log("Authentication"),n({operation:"AUTH",cert:o,algo:i,digest:r,language:e,mac:t,pin:a})},this.getUserCertificates=function(e,t){return console.log("Reading user certificates"),n({operation:"USERCERTS",language:e,mac:t})},this.getUserCertificateChain=function(e,t,o){return console.log("Getting certificate chain for specific cert"),n({operation:"CERTCHAIN",language:e,mac:t,cert:o})},this.getId=function(e,t,o){return console.log("ID"),n({operation:"ID",idflags:o.toString(),language:e,mac:t})},this.suspend=function(){console.log("Suspending pending promises"),o={}},console.log("EIDChromeExt interface initialized")}